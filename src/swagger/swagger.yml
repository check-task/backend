openapi: 3.0.0
info:
  title: UMC 9th
  description: UMC 9th Node.js 테스트 프로젝트입니다.
  version: 1.0.0

servers:
  - url: http://localhost:8000
    description: Local Development Server

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

tags:
  - name: Task
    description: 과제 관련 API
  - name: Alarm
    description: 알림 관련 API
  - name: User
    description: 사용자 관련 API
  - name: Folder
    description: 폴더 관련 API
  - name: Comment
    description: 댓글 관련 API
  - name: Modal
    description: 모달/자료 관련 API
  - name: Kakao Auth
    description: 카카오 인증 관련 API

paths:
  api/v1/alarm:
    get:
      tags:
        - Alarm
      summary: 알림 목록 조회
      description: 사용자의 알림 목록을 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: cursor
          schema:
            type: integer
          required: false
          description: 페이징 커서
        - in: query
          name: limit
          schema:
            type: integer
          required: false
          description: 조회 개수
          default: 10
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  data:
                    type: array
                    items:
                      type: object
        
    delete:
      tags:
        - Alarm
      summary: 전체 알림 삭제
      description: 사용자의 모든 알림을 삭제합니다.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 성공

  api/v1/alarm/{alarmId}:
    delete:
      tags:
        - Alarm
      summary: 개별 알림 삭제
      description: 특정 알림을 삭제합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: alarmId
          required: true
          schema:
            type: integer
          description: 알림 ID
      responses:
        '200':
          description: 성공

    patch:
      tags:
        - Alarm
      summary: 알림 읽음 처리
      description: 알림을 읽음으로 표시합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: alarmId
          required: true
          schema:
            type: integer
          description: 알림 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                isRead:
                  type: boolean
                  example: true
      responses:
        '200':
          description: 성공

  # 팀원 초대 링크 생성
  /api/v1/task/{taskId}/invitation:
    post:
      tags:
        - Task
      summary: 팀원 초대 링크 생성
      description: 팀원을 초대하기 위한 초대 링크를 생성합니다. (과제 소유자만 가능)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: taskId
          required: true
          schema:
            type: integer
          description: 초대 링크를 생성할 과제의 ID
      responses:
        '200':
          description: 초대 링크 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "초대 링크가 생성되었습니다."
                  data:
                    type: object
                    properties:
                      invite_code:
                        type: string
                        example: "ABC123"
                      invite_expired:
                        type: string
                        format: date-time
                        example: "2024-01-31T23:59:59.999Z"
        '400':
          description: |
            잘못된 요청
            - PERSONAL_TASK: 개인 과제는 초대 링크 생성이 불가능합니다.
        '403':
          description: |
            권한 없음
            - NOT_OWNER: 과제 소유자만 초대 링크를 생성할 수 있습니다.
        '404':
          description: |
            - TASK_NOT_FOUND: 과제를 찾을 수 없습니다.

  # 세부 TASK 상태 업데이트
  /api/v1/task/subtask/{subTaskId}/status:
    patch:
      tags:
        - Task
      summary: 세부 TASK 완료 상태 변경
      description: 세부 TASK의 완료 상태를 변경합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: subTaskId
          required: true
          schema:
            type: integer
          description: 상태를 변경할 세부 TASK ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum: [COMPLETE, PENDING]
                  description: 변경할 상태 (COMPLETE 또는 PENDING)
                  example: "COMPLETE"
      responses:
        '200':
          description: 세부 TASK 상태 업데이트 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "태스크 상태가 업데이트되었습니다."
                  data:
                    type: object
                    properties:
                      sub_task_id:
                        type: integer
                        example: 1
                      status:
                        type: string
                        example: "완료"
        '404':
          description: |
            - SUBTASK_NOT_FOUND: 해당하는 세부 태스크를 찾을 수 없습니다.
                      

  # 세부 TASK 마감일 변경
  /api/v1/task/subtask/{subTaskId}/deadline:
    patch:
      tags:
        - Task
      summary: 세부 TASK 마감일 변경
      description: 세부 TASK의 마감일을 변경합니다. 부모 Task의 마감일을 초과할 수 없습니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: subTaskId
          required: true
          schema:
            type: integer
          description: 마감일을 변경할 세부 TASK ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - endDate
              properties:
                endDate:
                  type: string
                  format: date
                  description: 변경할 마감일 (YYYY-MM-DD 형식)
                  example: "2026-01-31"
      responses:
        '200':
          description: 마감일 변경 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "마감 기한이 변경되었습니다."
                  data:
                    type: object
                    properties:
                      sub_task_id:
                        type: integer
                        example: 1
                      end_date:
                        type: string
                        format: date
                        example: "2026-01-31"
        '400':
          description: |
            - INVALID_DEADLINE: 부모 Task의 마감일을 초과할 수 없습니다.
        '404':
          description: |
            - SUBTASK_NOT_FOUND: 해당하는 세부 태스크를 찾을 수 없습니다.

  # 세부 TASK 담당자 설정
  /api/v1/task/subtask/{subTaskId}/assignee:
    patch:
      tags:
        - Task
      summary: 세부 TASK 담당자 설정
      description: 세부 TASK의 담당자를 설정합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: subTaskId
          required: true
          schema:
            type: integer
          description: 담당자를 설정할 세부 TASK ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - assigneeId
              properties:
                assigneeId:
                  type: integer
                  description: 담당자로 지정할 사용자 ID
                  example: 5
      responses:
        '200':
          description: 담당자 설정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "담당자가 지정되었습니다."
                  data:
                    type: object
                    properties:
                      sub_task_id:
                        type: integer
                        example: 10
                      assignee_id:
                        type: integer
                        example: 5

        '404':
          description: |
            - SUBTASK_NOT_FOUND: 해당하는 세부 태스크를 찾을 수 없습니다.
            - USER_NOT_FOUND: 지정된 사용자를 찾을 수 없습니다.
        '500':
          description: |
            - INTERNAL_SERVER_ERROR: 서버 오류가 발생했습니다.

  # 댓글 관련 API
  /api/v1/task/subtask/{subTaskId}/comments:
    post:
      tags:
        - Comment
      summary: 댓글 생성
      description: 세부 TASK에 새로운 댓글을 생성합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: subTaskId
          required: true
          schema:
            type: integer
          description: 댓글을 작성할 세부 TASK ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id              
                - content
              properties:
                user_id:
                  type: integer
                  description: 댓글 작성자 ID
                  example: 1
                content:
                  type: string
                  description: 댓글 내용
                  example: "세팅은 제가 할게요!"
                
      responses:
        '200':
          description: 댓글 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "댓글이 등록되었습니다."
                  data:
                    type: object
                    properties:
                      comment_id:
                        type: integer
                        example: 1
                      sub_task_id:
                        type: integer
                        example: 10
                      content:
                        type: string
                        example: "확인했습니다."
                      created_at:
                        type: string
                        format: date-time
                        example: "2024-01-25T08:30:00.000Z"

        '404':
          description: |
            - SUBTASK_NOT_FOUND: 해당하는 세부 태스크를 찾을 수 없습니다.
            - USER_NOT_FOUND: 사용자를 찾을 수 없습니다.


  /api/v1/task/comment/{commentId}:
    patch:
      tags:
        - Comment
      summary: 댓글 수정
      description: 기존 댓글을 수정합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: commentId
          required: true
          schema:
            type: integer
          description: 수정할 댓글 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  description: 수정할 댓글 내용
                  example: "수정된 댓글 내용입니다."
      responses:
        '200':
          description: 댓글 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "댓글이 수정되었습니다."
                  data:
                    type: object
                    properties:
                      comment_id:
                        type: integer
                        example: 1
                      content:
                        type: string
                        example: "수정된 댓글 내용입니다."

        '403':
          description: |
            - PERMISSION_DENIED: 댓글 수정 권한이 없습니다.
        '404':
          description: |
            - COMMENT_NOT_FOUND: 댓글을 찾을 수 없습니다.
        '500':
          description: |
            - INTERNAL_SERVER_ERROR: 서버 오류가 발생했습니다.

    delete:
      tags:
        - Comment
      summary: 댓글 삭제
      description: 댓글을 삭제합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: commentId
          required: true
          schema:
            type: integer
          description: 삭제할 댓글 ID
      responses:
        '200':
          description: 댓글 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "댓글이 삭제되었습니다."
                  data:
                    type: "null"
                    example: null

        '403':
          description: |
            - FORBIDDEN: 삭제 권한이 없습니다.
        '404':
          description: |
            - COMMENT_NOT_FOUND: 댓글을 찾을 수 없습니다.
        '500':
          description: |
            - INTERNAL_SERVER_ERROR: 서버 내부 오류가 발생했습니다.



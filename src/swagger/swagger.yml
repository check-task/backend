openapi: 3.0.0
info:
  title: UMC 9th
  description: UMC 9th Node.js 테스트 프로젝트입니다.
  version: 1.0.0

servers:
  - url: http://localhost:3000
    description: Local Development Server

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

tags:
  - name: Task
    description: 과제 관련 API
  - name: Alarm
    description: 알림 관련 API
  - name: User
    description: 사용자 관련 API
  - name: Folder
    description: 폴더 관련 API
  - name: Comment
    description: 댓글 관련 API
  - name: Modal
    description: 모달/자료 관련 API
  - name: Kakao Auth
    description: 카카오 인증 관련 API

paths:
  api/v1/alarm:
    get:
      tags:
        - Alarm
      summary: 알림 목록 조회
      description: 사용자의 알림 목록을 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: cursor
          schema:
            type: integer
          required: false
          description: 페이징 커서
        - in: query
          name: limit
          schema:
            type: integer
          required: false
          description: 조회 개수
          default: 10
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  data:
                    type: array
                    items:
                      type: object
        
    delete:
      tags:
        - Alarm
      summary: 전체 알림 삭제
      description: 사용자의 모든 알림을 삭제합니다.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 성공

  api/v1/alarm/{alarmId}:
    delete:
      tags:
        - Alarm
      summary: 개별 알림 삭제
      description: 특정 알림을 삭제합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: alarmId
          required: true
          schema:
            type: integer
          description: 알림 ID
      responses:
        '200':
          description: 성공

    patch:
      tags:
        - Alarm
      summary: 알림 읽음 처리
      description: 알림을 읽음으로 표시합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: alarmId
          required: true
          schema:
            type: integer
          description: 알림 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                isRead:
                  type: boolean
                  example: true
      responses:
        '200':
          description: 성공
  
  # -- 과제 API --
  # 과제 등록
  /api/v1/task:
    post:
      tags:
        - Task
      summary: 과제 생성
      description: 새로운 과제와 세부 태스크들을 생성합니다.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, deadline, type]
              properties:
                title:
                  type: string
                  example: "프로젝트1"
                folderId:
                  type: integer
                  example: 1
                deadline:
                  type: string
                  format: date
                  example: "2026-05-10"
                type:
                  type: string
                  enum: [TEAM, PERSONAL]
                  example: "PERSONAL"
                subTasks:
                  type: array
                  items:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "세부과제1"
                      endDate:
                        type: string
                        format: date
                        example: "2026-05-05"
                references:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                        example: "참고 문서 1"
                      url:
                        type: string
                        example: "https://example.com"
      responses:
        '201':
          description: 과제 등록 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "요청이 처리되어서 새로운 과제가 생성되었습니다."
                  data:
                    type: object
                    properties:
                      taskId:
                        type: integer
                        example: 13

    # 과제 목록 조회
    get:
      tags:
        - Task
      summary: 과제 목록 조회
      description: 필터(유형, 폴더) 및 정렬 조건에 따라 과제 목록을 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: type
          schema:
            type: string
            enum: [TEAM, PERSONAL]
          description: 과제 유형 필터
        - in: query
          name: folderId
          schema:
            type: integer
          description: 폴더별 필터
        - in: query
          name: sort
          schema:
            type: string
            enum: [PROGRESSRATE, DEADLINE, PRIORITY]
          description: 정렬 기준 (진척도순, 마감임박순, 우선순위순)
      responses:
        '200':
          description: 과제 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message: 
                    type: string
                    example: "서버가 요청을 성공적으로 처리하였습니다."
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        taskId:
                          type: integer
                          example: 1
                        folderId:
                          type: integer
                          example: 1
                        folderTitle:
                          type: string
                          example: "PENDING"
                        title:
                          type: string
                          example: "프로젝트1"
                        type:
                          type: string
                          example: "TEAM"
                        deadline:
                          type: string
                          example: "2026.06.15"
                        dDay:
                          type: string
                          example: "D-10"
                        progressRate:
                          type: integer
                          example: "50"

  # 과제 상세 조회
  /api/v1/task/{taskId}:
    get:
      tags:
        - Task
      summary: 과제 상세 정보 조회
      description: 특정 과제의 세부 태스크, 진행률, 팀원 정보 등을 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: taskId
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 과제 상세 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "서버가 요청을 성공적으로 처리하였습니다."
                  data:
                    type: object
                    properties:
                      taskId:
                        type: integer
                        example: 1
                      title:
                        type: string
                        example: "프로젝트1"
                      type:
                        type: string
                        example: "TEAM"
                      deadline:
                        type: string
                        format: date
                        example: "2026-06-15"
                      dDay:
                        type: string
                        example: "D-10"
                      progressRate:
                        type: integer
                        example: 0
                      subTasks:
                        type: array
                        items:
                          type: object
                          properties:
                            subTaskId:
                              type: integer
                              example: 1
                            title:
                              type: string
                              example: "세부과제 1"
                            deadline:
                              type: string
                              format: date
                              example: "2026-05-10"
                            status:
                              type: string
                              example: "PROGRESS"
                            isAlarm:
                              type: boolean
                              example: true
                            commentCount:
                              type: integer
                              example: 0
                            assigneeName:
                              type: string
                              example: "PENDING"
                      communications:
                        type: array
                        items:
                          type: object
                        example: []
                      meetingLogs:
                        type: array
                        items:
                          type: object
                        example: []
                      references:
                        type: array
                        items:
                          type: object
                          properties:
                            name:
                              type: string
                              example: "레퍼런스1"
                            url:
                              type: string
                              example: "https://www.example.com"
    
    # 과제 수정
    patch:
      tags:
        - Task
      summary: 과제 수정
      description: 과제의 기본 정보 및 세부 태스크를 수정합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: taskId
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                deadline:
                  type: string
                  format: date
      responses:
        '200':
          description: 과제 수정 성공
          content:
            application/json:
              schema:
              type: object
              properties:
                resultType: 
                  type: string
                  example: "SUCCESS"
                message:
                  type: string
                  example: "요청이 성공적으로 처리되었습니다."
                data:
                  type: object
                  properties:
                    taskId: 
                      type: integer
                      example: 1


    # 과제 삭제
    delete:
      tags:
        - Task
      summary: 과제 삭제
      description: 과제를 삭제합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: taskId
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 과제 삭제 성공
          content:
            application/json:
              schema:
              type: object
              properties:
                resultType:
                  type: string
                  example: "SUCCESS"
                message: 
                  type: string
                  example: "과제가 성공적으로 삭제되었습니다."
                data:
                  type: "null"
                  example: null


  # 우선순위 일괄 수정
  /api/v1/task/priority:
    patch:
      tags:
        - Task
      summary: 과제 우선순위 일괄 변경
      description: 드래그 앤 드롭으로 변경된 과제들의 순서를 일괄 저장합니다.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                orderedTasks:
                  type: array
                  items:
                    type: object
                    properties:
                      taskId:
                        type: integer
                      rank:
                        type: integer
      responses:
        '200':
          description: 우선순위 변경 성공
          content:
           application/json:
            schema:
              type: object
              properties:
                resultType:
                  type: string
                  example: "SUCCESS"
                message: 
                  type: string
                  example: "과제 우선순위가 일괄 변경되었습니다." 
                data:
                  type: null
                  example: null

  # 팀원 정보(역할) 수정
  /api/v1/task/{taskId}/member/{memberId}:
    patch:
      tags:
        - Task
      summary: 팀원 역할 수정
      description: 팀원의 역할(관리자/일반)을 변경합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: taskId
          required: true
          schema:
            type: integer
        - in: path
          name: memberId
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                role:
                  type: integer
                  description: "0: 일반, 1: 관리자"
                  example: 1
      responses:
        '200':
          description: 역할 수정 성공
          content:
            application/json:
              schema:
              type: object
              properties:
                resultType:
                  type: string
                  example: "SUCCESS"
                message: 
                  type: string
                  example: "요청이 성공적으로 처리되었습니다."
                data:
                    type: object
                    properties:
                      memberId:
                        type: integer
                        example: 1
                      userid:
                        type: integer
                        example: 1
                      taskId:
                        type: integer
                        example: 1
                      role:
                        type: integer
                        example: 1


  # 팀원 초대 링크 생성
  /api/v1/task/{taskId}/invitation:
    post:
      tags:
        - Task
      summary: 팀원 초대 링크 생성
      description: 팀원을 초대하기 위한 초대 링크를 생성합니다. (과제 소유자만 가능)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: taskId
          required: true
          schema:
            type: integer
          description: 초대 링크를 생성할 과제의 ID
      responses:
        '200':
          description: 초대 링크 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "초대 링크가 생성되었습니다."
                  data:
                    type: object
                    properties:
                      invite_code:
                        type: string
                        example: "ABC123"
                      invite_expired:
                        type: string
                        format: date-time
                        example: "2024-01-31T23:59:59.999Z"
        '400':
          description: |
            잘못된 요청
            - PERSONAL_TASK: 개인 과제는 초대 링크 생성이 불가능합니다.
        '403':
          description: |
            권한 없음
            - NOT_OWNER: 과제 소유자만 초대 링크를 생성할 수 있습니다.
        '404':
          description: |
            - TASK_NOT_FOUND: 과제를 찾을 수 없습니다.

  # 세부 TASK 상태 업데이트
  /api/v1/task/subtask/{subTaskId}/status:
    patch:
      tags:
        - Task
      summary: 세부 TASK 완료 상태 변경
      description: 세부 TASK의 완료 상태를 변경합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: subTaskId
          required: true
          schema:
            type: integer
          description: 상태를 변경할 세부 TASK ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum: [COMPLETE, PENDING]
                  description: 변경할 상태 (COMPLETE 또는 PENDING)
                  example: "COMPLETE"
      responses:
        '200':
          description: 세부 TASK 상태 업데이트 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "태스크 상태가 업데이트되었습니다."
                  data:
                    type: object
                    properties:
                      sub_task_id:
                        type: integer
                        example: 1
                      status:
                        type: string
                        example: "완료"
        '404':
          description: |
            - SUBTASK_NOT_FOUND: 해당하는 세부 태스크를 찾을 수 없습니다.
                      

  # 세부 TASK 마감일 변경
  /api/v1/task/subtask/{subTaskId}/deadline:
    patch:
      tags:
        - Task
      summary: 세부 TASK 마감일 변경
      description: 세부 TASK의 마감일을 변경합니다. 부모 Task의 마감일을 초과할 수 없습니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: subTaskId
          required: true
          schema:
            type: integer
          description: 마감일을 변경할 세부 TASK ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - endDate
              properties:
                endDate:
                  type: string
                  format: date
                  description: 변경할 마감일 (YYYY-MM-DD 형식)
                  example: "2026-01-31"
      responses:
        '200':
          description: 마감일 변경 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "마감 기한이 변경되었습니다."
                  data:
                    type: object
                    properties:
                      sub_task_id:
                        type: integer
                        example: 1
                      end_date:
                        type: string
                        format: date
                        example: "2026-01-31"
        '400':
          description: |
            - INVALID_DEADLINE: 부모 Task의 마감일을 초과할 수 없습니다.
        '404':
          description: |
            - SUBTASK_NOT_FOUND: 해당하는 세부 태스크를 찾을 수 없습니다.

  # 세부 TASK 담당자 설정
  /api/v1/task/subtask/{subTaskId}/assignee:
    patch:
      tags:
        - Task
      summary: 세부 TASK 담당자 설정
      description: 세부 TASK의 담당자를 설정합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: subTaskId
          required: true
          schema:
            type: integer
          description: 담당자를 설정할 세부 TASK ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - assigneeId
              properties:
                assigneeId:
                  type: integer
                  description: 담당자로 지정할 사용자 ID
                  example: 5
      responses:
        '200':
          description: 담당자 설정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "담당자가 지정되었습니다."
                  data:
                    type: object
                    properties:
                      sub_task_id:
                        type: integer
                        example: 10
                      assignee_id:
                        type: integer
                        example: 5

        '404':
          description: |
            - SUBTASK_NOT_FOUND: 해당하는 세부 태스크를 찾을 수 없습니다.
            - USER_NOT_FOUND: 지정된 사용자를 찾을 수 없습니다.
        '500':
          description: |
            - INTERNAL_SERVER_ERROR: 서버 오류가 발생했습니다.

  # 댓글 관련 API
  /api/v1/task/subtask/{subTaskId}/comments:
    post:
      tags:
        - Comment
      summary: 댓글 생성
      description: 세부 TASK에 새로운 댓글을 생성합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: subTaskId
          required: true
          schema:
            type: integer
          description: 댓글을 작성할 세부 TASK ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id              
                - content
              properties:
                user_id:
                  type: integer
                  description: 댓글 작성자 ID
                  example: 1
                content:
                  type: string
                  description: 댓글 내용
                  example: "세팅은 제가 할게요!"
                
      responses:
        '200':
          description: 댓글 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "댓글이 등록되었습니다."
                  data:
                    type: object
                    properties:
                      comment_id:
                        type: integer
                        example: 1
                      sub_task_id:
                        type: integer
                        example: 10
                      content:
                        type: string
                        example: "확인했습니다."
                      created_at:
                        type: string
                        format: date-time
                        example: "2024-01-25T08:30:00.000Z"

        '404':
          description: |
            - SUBTASK_NOT_FOUND: 해당하는 세부 태스크를 찾을 수 없습니다.
            - USER_NOT_FOUND: 사용자를 찾을 수 없습니다.


  /api/v1/task/comment/{commentId}:
    patch:
      tags:
        - Comment
      summary: 댓글 수정
      description: 기존 댓글을 수정합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: commentId
          required: true
          schema:
            type: integer
          description: 수정할 댓글 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  description: 수정할 댓글 내용
                  example: "수정된 댓글 내용입니다."
      responses:
        '200':
          description: 댓글 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "댓글이 수정되었습니다."
                  data:
                    type: object
                    properties:
                      comment_id:
                        type: integer
                        example: 1
                      content:
                        type: string
                        example: "수정된 댓글 내용입니다."

        '403':
          description: |
            - PERMISSION_DENIED: 댓글 수정 권한이 없습니다.
        '404':
          description: |
            - COMMENT_NOT_FOUND: 댓글을 찾을 수 없습니다.
        '500':
          description: |
            - INTERNAL_SERVER_ERROR: 서버 오류가 발생했습니다.

    delete:
      tags:
        - Comment
      summary: 댓글 삭제
      description: 댓글을 삭제합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: commentId
          required: true
          schema:
            type: integer
          description: 삭제할 댓글 ID
      responses:
        '200':
          description: 댓글 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "댓글이 삭제되었습니다."
                  data:
                    type: "null"
                    example: null

        '403':
          description: |
            - FORBIDDEN: 삭제 권한이 없습니다.
        '404':
          description: |
            - COMMENT_NOT_FOUND: 댓글을 찾을 수 없습니다.
        '500':
          description: |
            - INTERNAL_SERVER_ERROR: 서버 내부 오류가 발생했습니다.


